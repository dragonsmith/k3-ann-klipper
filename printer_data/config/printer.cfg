# JUST A NOTE, THIS REQUIRES THE FOLLOWING KLIPPER MODULE TO FUNCTION: https://github.com/Annex-Engineering/klipper/blob/master/klippy/extras/dockable_probe.py
# Documentation can be found here: https://github.com/Annex-Engineering/klipper/blob/master/docs/Dockable_Probe.md

# This file has been created by Trails, of Annex Engineering, for the K3 3D Printer.
# Please change settings for your specific build or ensure you place your items in the same spots on the same MCU as I have.
# I've added as many options as I can think of for different displays as well as listed the available commands you can use via the terminal at the bottom of this configuration file.

#THIS CONFIG IS FOR A 180mm x 180mm x 180mm K3 PRINTER ONLY FOR THE MELLOW SUPER 8
#PLEASE READ THE WHOLE CONFIG BEFORE ATTEMPTING TO DO ANYTHING
#CONNECTORS/PORTS ON THE CONTROLLERS ARE NOTED WITH COMMENTS FOR EACH LOCATION/INPUT/OUTPUT

# use the following modifiers before the pin definition (ex: ^!ar99)
# ! 			invert the logic
# ^ 			activate 5v pullup (does not apply to all pins)
# mcu_name: 	use pins on additional MCU (ex: z:ar10)

# |------------------------|
# |        BACKPACK        |
# |------------------------|
# | Y  |    | Z1 |    | X1 |
# |-----    ------    -----|
# |                        |
# | ------          ------ |
# | | Z  |          | Z2 | |
# | ------          ------ |
# |-----              -----|
# | X  |              | Y1 |
# |------------------------|

[mcu] 
#   You will need to set this definition manually following the instructions in the line below
#	obtain definition by "ls -l /dev/serial/by-id/" then unplug to verify
serial: /dev/serial/by-id/usb-Klipper_stm32f446xx_410031001950534841313020-if00

[mcu rpi]
serial: /tmp/klipper_host_mcu


# [adxl345]
# cs_pin: rpi:None

# [mcu RP2040]
# baud: 115200 # 250000
# restart_method: command
# serial: /dev/serial/by-id/usb-Klipper_rp2040_E6614C309320822D-if00


# [adxl345]
# # Pins for RP2040
# cs_pin: RP2040:gpio1
# spi_bus: spi0a

# [resonance_tester]
# accel_chip: adxl345
# probe_points:
#     90, 90, 20  # an example

#virtual sdcard settings
[virtual_sdcard]
path: ~/gcode_files

[exclude_object]

# Enable Pause/Resume Functionality
[pause_resume]

#Printer Speeds and Accels
[printer]
kinematics: cartesian
max_velocity: 600
max_accel: 18000 # change this to 7500 after commissioning
max_z_velocity: 40  # may be able to increase to 15 after comissioning.
max_z_accel: 350
square_corner_velocity: 15.0 # start at 8, but then increase once you're sure assembly is sound

#Gcode G2/G3 Arc Support
[gcode_arcs]
resolution: 0.1

# Force Move used to force a single stepper to move. Not used once setup complete
[force_move]
enable_force_move: true

# Motor and Heater Idle Timeout
[idle_timeout]
timeout: 6000

[include printer/input_shaper.cfg]
[include printer/stepper_drivers.cfg]
[include printer/steppers.cfg]
[include printer/beacon.cfg]
[include printer/extruder.cfg]
[include printer/bed.cfg]
[include printer/fans.cfg]
[include printer/bed_mesh.cfg]
[include printer/z_tilt.cfg]
[include printer/additional_temp_sensors.cfg]

[include macros/annex.cfg]
[include macros/z_tilt.cfg]
[include macros/print_end.cfg]

[include mainsail.cfg]

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [bed_mesh PET]
#*# version = 1
#*# points =
#*# 	0.050000, 0.017500, 0.055000, 0.050000, 0.035000, 0.037500, 0.047500, 0.072500, 0.057500, 0.075000
#*# 	0.052500, 0.055000, 0.087500, 0.032500, 0.057500, 0.040000, 0.017500, 0.080000, 0.055000, 0.042500
#*# 	0.027500, 0.025000, 0.055000, 0.032500, 0.005000, 0.037500, 0.050000, 0.037500, 0.052500, 0.025000
#*# 	0.055000, 0.027500, 0.027500, 0.020000, 0.002500, 0.007500, 0.007500, 0.027500, -0.002500, -0.005000
#*# 	0.020000, 0.015000, 0.022500, 0.017500, 0.000000, 0.015000, 0.010000, 0.015000, 0.012500, 0.002500
#*# 	0.037500, -0.015000, 0.010000, -0.010000, -0.007500, 0.005000, -0.010000, 0.012500, -0.005000, -0.002500
#*# 	0.010000, 0.012500, 0.007500, -0.007500, -0.022500, 0.005000, -0.010000, -0.025000, -0.010000, -0.022500
#*# 	0.045000, 0.065000, 0.007500, -0.005000, -0.002500, 0.000000, 0.002500, 0.015000, 0.000000, -0.012500
#*# 	0.047500, 0.052500, -0.010000, 0.032500, 0.000000, 0.000000, 0.022500, 0.002500, 0.005000, -0.010000
#*# 	0.047500, 0.045000, 0.015000, 0.002500, 0.020000, 0.025000, 0.022500, 0.015000, 0.042500, 0.060000
#*# x_count = 10
#*# y_count = 10
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.1
#*# min_x = 20.0
#*# max_x = 149.96
#*# min_y = 25.0
#*# max_y = 154.96
#*#
#*# [bed_mesh ASA]
#*# version = 1
#*# points =
#*# 	0.035000, 0.005000, -0.010000, 0.037500, 0.012500, 0.015000, 0.020000, 0.040000, 0.025000, 0.040000
#*# 	0.030000, 0.007500, 0.057500, 0.015000, 0.015000, 0.025000, -0.020000, 0.012500, 0.040000, 0.037500
#*# 	-0.010000, 0.025000, 0.010000, -0.000000, -0.022500, -0.012500, 0.007500, -0.017500, -0.022500, -0.012500
#*# 	0.007500, -0.012500, 0.002500, 0.007500, -0.025000, -0.037500, -0.020000, -0.025000, -0.025000, 0.022500
#*# 	-0.015000, -0.035000, -0.045000, -0.010000, 0.000000, -0.035000, -0.007500, -0.020000, -0.012500, -0.027500
#*# 	-0.020000, -0.002500, -0.032500, -0.020000, -0.020000, -0.030000, -0.035000, -0.032500, -0.030000, -0.017500
#*# 	0.037500, 0.022500, -0.022500, 0.020000, -0.050000, 0.000000, -0.055000, -0.017500, -0.035000, -0.047500
#*# 	0.030000, -0.015000, -0.012500, -0.012500, -0.045000, -0.027500, -0.030000, -0.040000, -0.052500, -0.035000
#*# 	0.005000, 0.025000, -0.002500, -0.005000, -0.012500, -0.020000, -0.005000, -0.010000, 0.027500, -0.010000
#*# 	0.040000, 0.035000, 0.020000, 0.027500, -0.005000, 0.007500, 0.035000, 0.010000, 0.027500, 0.017500
#*# x_count = 10
#*# y_count = 10
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.1
#*# min_x = 20.0
#*# max_x = 149.96
#*# min_y = 25.0
#*# max_y = 154.96
#*#
#*# [bed_mesh ASA-satin]
#*# version = 1
#*# points =
#*# 	0.027500, 0.030000, 0.030000, 0.025000, 0.032500, 0.035000, 0.040000, 0.037500, 0.032500, 0.032500
#*# 	0.017500, 0.017500, 0.020000, 0.022500, 0.025000, 0.017500, 0.022500, 0.020000, 0.020000, 0.017500
#*# 	0.007500, 0.007500, 0.005000, -0.000000, 0.005000, 0.002500, 0.005000, 0.005000, 0.002500, -0.000000
#*# 	0.005000, 0.005000, -0.002500, -0.000000, 0.002500, -0.002500, -0.000000, -0.002500, -0.005000, -0.010000
#*# 	-0.000000, -0.010000, -0.012500, -0.007500, 0.000000, -0.005000, -0.005000, -0.002500, -0.007500, -0.020000
#*# 	-0.005000, -0.017500, -0.010000, -0.007500, -0.012500, -0.007500, -0.007500, -0.010000, -0.022500, -0.025000
#*# 	-0.005000, -0.015000, -0.017500, -0.020000, -0.017500, -0.022500, -0.010000, -0.015000, -0.022500, -0.025000
#*# 	0.000000, 0.000000, -0.007500, -0.015000, -0.012500, -0.015000, -0.015000, -0.010000, -0.015000, -0.027500
#*# 	0.015000, 0.007500, 0.000000, -0.002500, 0.000000, -0.005000, -0.002500, 0.005000, 0.000000, -0.005000
#*# 	0.027500, 0.020000, 0.017500, 0.015000, 0.017500, 0.017500, 0.022500, 0.027500, 0.025000, 0.032500
#*# x_count = 10
#*# y_count = 10
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.1
#*# min_x = 20.0
#*# max_x = 149.96
#*# min_y = 25.0
#*# max_y = 154.96
#*#
#*# [bed_mesh PET-satin]
#*# version = 1
#*# points =
#*# 	0.012500, 0.010000, 0.015000, 0.015000, 0.017500, 0.020000, 0.027500, 0.025000, 0.020000, 0.010000
#*# 	0.007500, 0.012500, 0.012500, 0.015000, 0.017500, 0.015000, 0.015000, 0.012500, 0.002500, 0.002500
#*# 	-0.002500, -0.000000, 0.002500, -0.002500, -0.000000, 0.002500, -0.000000, -0.000000, -0.005000, -0.012500
#*# 	0.007500, 0.005000, -0.002500, -0.005000, 0.002500, -0.000000, -0.002500, -0.002500, -0.007500, -0.015000
#*# 	-0.002500, -0.010000, -0.010000, -0.010000, 0.000000, -0.002500, 0.000000, 0.000000, 0.005000, -0.012500
#*# 	-0.002500, -0.015000, -0.010000, -0.002500, -0.010000, -0.005000, -0.005000, 0.000000, 0.010000, -0.007500
#*# 	0.002500, -0.010000, -0.015000, -0.012500, -0.010000, -0.015000, -0.005000, -0.007500, -0.012500, -0.022500
#*# 	0.012500, 0.002500, 0.005000, -0.005000, 0.000000, -0.002500, -0.007500, -0.002500, -0.017500, -0.025000
#*# 	0.020000, 0.010000, 0.005000, 0.002500, 0.005000, 0.002500, 0.000000, 0.012500, -0.002500, -0.010000
#*# 	0.030000, 0.022500, 0.025000, 0.020000, 0.022500, 0.025000, 0.027500, 0.030000, 0.022500, 0.012500
#*# x_count = 10
#*# y_count = 10
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.1
#*# min_x = 20.0
#*# max_x = 149.96
#*# min_y = 25.0
#*# max_y = 154.96
#*#
#*# [beacon model default]
#*# model_coef = 1.5001732375131274,
#*# 	  1.8111493519419748,
#*# 	  0.7474436771405629,
#*# 	  0.35795002321156694,
#*# 	  0.30098589916125895,
#*# 	  0.3163465292714478,
#*# 	  -0.13567123991401586,
#*# 	  -0.2646292490473933,
#*# 	  0.18790882034601578,
#*# 	  0.18082718427986244
#*# model_domain = 3.213675420922692e-07,3.3468828743996905e-07
#*# model_range = 0.200000,5.000000
#*# model_temp = 69.991045
#*# model_offset = 0.00000
#*#
#*# [bed_mesh 11x11 400 ]
#*# version = 1
#*# points =
#*# 	0.055943, 0.075395, 0.080356, 0.098550, 0.089448, 0.105315, 0.120377, 0.120274, 0.095502, 0.086426, 0.071308
#*# 	0.025386, 0.039852, 0.050192, 0.057711, 0.062617, 0.070929, 0.077530, 0.082756, 0.091210, 0.101758, 0.078392
#*# 	0.026676, 0.044331, 0.048821, 0.034475, 0.044849, 0.067765, 0.073905, 0.076272, 0.079194, 0.060251, 0.059673
#*# 	-0.008819, 0.000266, 0.006213, 0.025025, 0.032581, 0.043687, 0.052519, 0.037474, 0.036729, 0.028974, 0.029193
#*# 	-0.021177, -0.026003, -0.020809, -0.015882, -0.008505, 0.010755, 0.010605, 0.007268, 0.010222, 0.011825, 0.028954
#*# 	-0.033209, -0.025103, -0.017364, -0.007066, -0.003343, 0.000000, 0.003951, 0.007840, 0.007872, 0.013557, 0.009332
#*# 	-0.040383, -0.025673, -0.006783, 0.002189, 0.005569, 0.004167, 0.002509, 0.012992, 0.005428, -0.002998, -0.004503
#*# 	-0.044296, -0.043786, -0.040023, -0.035875, -0.030450, -0.019293, 0.002981, 0.007758, 0.002811, 0.002009, -0.003954
#*# 	-0.044750, -0.040006, -0.034031, -0.030991, -0.028111, -0.023597, -0.013927, -0.006860, 0.000002, -0.005943, -0.000619
#*# 	-0.021945, -0.005519, 0.004479, -0.013498, -0.019679, -0.010068, -0.003795, 0.005132, 0.010998, 0.013863, 0.011461
#*# 	-0.017203, -0.023089, -0.005194, 0.003783, 0.013074, 0.015036, 0.016584, 0.023176, 0.023480, 0.036588, 0.056445
#*# x_count = 11
#*# y_count = 11
#*# mesh_x_pps = 0
#*# mesh_y_pps = 0
#*# algo = direct
#*# tension = 0.1
#*# min_x = 21.0
#*# max_x = 153.0
#*# min_y = 28.0
#*# max_y = 162.0
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	0.044829, 0.057326, 0.059935, 0.072113, 0.078491, 0.074959, 0.090493, 0.113688, 0.125472, 0.114551, 0.105593, 0.092176, 0.094246
#*# 	0.024513, 0.041019, 0.056074, 0.067027, 0.067444, 0.067981, 0.077795, 0.093739, 0.105779, 0.103055, 0.099783, 0.105616, 0.075254
#*# 	0.011917, 0.028442, 0.041884, 0.046274, 0.049756, 0.055652, 0.068041, 0.083794, 0.091578, 0.093577, 0.091962, 0.075875, 0.060113
#*# 	-0.017143, -0.001750, 0.007458, 0.012713, 0.020071, 0.023515, 0.036284, 0.049523, 0.058890, 0.060445, 0.054405, 0.050650, 0.048169
#*# 	-0.022081, -0.016666, -0.007599, -0.004629, 0.004804, 0.011427, 0.020659, 0.022980, 0.034492, 0.037447, 0.037059, 0.037354, 0.036021
#*# 	-0.037521, -0.031288, -0.024804, -0.017450, -0.004199, 0.004445, 0.005497, 0.010656, 0.020064, 0.021295, 0.019713, 0.017621, 0.018420
#*# 	-0.051713, -0.045449, -0.027823, -0.027687, -0.016030, -0.010878, 0.000000, 0.008722, 0.013156, 0.015097, 0.015927, 0.012312, -0.003485
#*# 	-0.034556, -0.032926, -0.019238, -0.021521, -0.020376, -0.012231, -0.004608, -0.002622, 0.003800, 0.003299, 0.009148, 0.011349, -0.007579
#*# 	-0.032413, -0.033517, -0.033142, -0.033760, -0.025758, -0.019417, -0.014620, 0.002279, 0.007921, 0.007389, 0.002572, -0.000632, -0.010557
#*# 	-0.032106, -0.019138, -0.032337, -0.036177, -0.032595, -0.024300, -0.014680, -0.004727, 0.001833, 0.007359, 0.005423, -0.001724, -0.010060
#*# 	-0.023026, -0.015182, -0.007315, -0.012921, -0.015836, -0.014093, -0.010025, -0.000183, 0.004952, 0.014845, 0.008600, 0.010998, 0.005376
#*# 	-0.004641, -0.002975, 0.003498, 0.010975, 0.016487, 0.007342, 0.013654, 0.024243, 0.025849, 0.030926, 0.033947, 0.042400, 0.038483
#*# 	0.010284, 0.003206, 0.007628, 0.016849, 0.019226, 0.023355, 0.032854, 0.032592, 0.040961, 0.042447, 0.047932, 0.060189, 0.062442
#*# x_count = 13
#*# y_count = 13
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.1
#*# min_x = 21.0
#*# max_x = 153.0
#*# min_y = 28.0
#*# max_y = 163.5
#*#
#*# [bed_mesh old]
#*# version = 1
#*# points =
#*# 	0.044829, 0.057326, 0.059935, 0.072113, 0.078491, 0.074959, 0.090493, 0.113688, 0.125472, 0.114551, 0.105593, 0.092176, 0.094246
#*# 	0.024513, 0.041019, 0.056074, 0.067027, 0.067444, 0.067981, 0.077795, 0.093739, 0.105779, 0.103055, 0.099783, 0.105616, 0.075254
#*# 	0.011917, 0.028442, 0.041884, 0.046274, 0.049756, 0.055652, 0.068041, 0.083794, 0.091578, 0.093577, 0.091962, 0.075875, 0.060113
#*# 	-0.017143, -0.001750, 0.007458, 0.012713, 0.020071, 0.023515, 0.036284, 0.049523, 0.058890, 0.060445, 0.054405, 0.050650, 0.048169
#*# 	-0.022081, -0.016666, -0.007599, -0.004629, 0.004804, 0.011427, 0.020659, 0.022980, 0.034492, 0.037447, 0.037059, 0.037354, 0.036021
#*# 	-0.037521, -0.031288, -0.024804, -0.017450, -0.004199, 0.004445, 0.005497, 0.010656, 0.020064, 0.021295, 0.019713, 0.017621, 0.018420
#*# 	-0.051713, -0.045449, -0.027823, -0.027687, -0.016030, -0.010878, 0.000000, 0.008722, 0.013156, 0.015097, 0.015927, 0.012312, -0.003485
#*# 	-0.034556, -0.032926, -0.019238, -0.021521, -0.020376, -0.012231, -0.004608, -0.002622, 0.003800, 0.003299, 0.009148, 0.011349, -0.007579
#*# 	-0.032413, -0.033517, -0.033142, -0.033760, -0.025758, -0.019417, -0.014620, 0.002279, 0.007921, 0.007389, 0.002572, -0.000632, -0.010557
#*# 	-0.032106, -0.019138, -0.032337, -0.036177, -0.032595, -0.024300, -0.014680, -0.004727, 0.001833, 0.007359, 0.005423, -0.001724, -0.010060
#*# 	-0.023026, -0.015182, -0.007315, -0.012921, -0.015836, -0.014093, -0.010025, -0.000183, 0.004952, 0.014845, 0.008600, 0.010998, 0.005376
#*# 	-0.004641, -0.002975, 0.003498, 0.010975, 0.016487, 0.007342, 0.013654, 0.024243, 0.025849, 0.030926, 0.033947, 0.042400, 0.038483
#*# 	0.010284, 0.003206, 0.007628, 0.016849, 0.019226, 0.023355, 0.032854, 0.032592, 0.040961, 0.042447, 0.047932, 0.060189, 0.062442
#*# x_count = 13
#*# y_count = 13
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.1
#*# min_x = 21.0
#*# max_x = 153.0
#*# min_y = 28.0
#*# max_y = 163.5
